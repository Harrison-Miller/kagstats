version: "3.7"
services:
  mysql:
    build:
      context: .
      dockerfile: Dockerfile-mysql
    ports:
      - "3306:3306"
    environment:
      - MYSQL_ROOT_PASSWORD=password
      - MYSQL_DATABASE=kagstats
  api:
    build:
      context: .
      dockerfile: Dockerfile-api
    image: kagstats-api:0.1
    ports:
      - "8080:8080"
    links:
      - mysql
  basic-indexer:
    build:
      context: .
      dockerfile: Dockerfile-indexer
      args:
        indexer: basic
    image: kagstats-basic-indexer:0.1
    environment:
      - INDEXER_INTERVAL=10s
    links:
      - mysql
  nemesis-indexer:
    build:
      context: .
      dockerfile: Dockerfile-indexer
      args:
        indexer: nemesis
    image: kagstats-nemesis-indexer:0.1
    environment:
      - INDEXER_INTERVAL=10s
    links:
      - mysql
  hitters-indexer:
    build:
      context: .
      dockerfile: Dockerfile-indexer
      args:
        indexer: hitters
    image: kagstats-hitters-indexer:0.1
    environment:
      - INDEXER_INTERVAL=10s
    links:
      - mysql
